<!doctype html>
<html>
<head>
  <link rel="stylesheet" href="css/common.css">

  <meta charset="utf-8"/>
  <title>Edit Task</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>  <link rel="stylesheet" href="css/edit_task.css">
</head>
<body>
  <div class="page">
    <h1>Edit Task</h1>
    
    <div id="message"></div>
    
    <div id="taskInfo" style="margin:12px 0;padding:12px;background:#f0f0f0;border-radius:4px;display:none;">
      <div style="display:flex;gap:20px;flex-wrap:wrap;font-size:0.9em;color:#555;">
        <span><strong>Task ID:</strong> <span id="taskId">-</span></span>
        <span><strong>Created:</strong> <span id="createdDate">-</span></span>
        <span><strong>Created by:</strong> <span id="createdBy">-</span></span>
      </div>
    </div>
    
    <div id="pageLoading" style="padding:20px;text-align:center;color:#666;">
      Loading task details...
    </div>
    
    <form id="editTaskForm" style="display:none;">
      <label>Title</label>
      <input id="title" required maxlength="100" />
      
      <label>Description</label>
      <textarea id="description" rows="4" required maxlength="500"></textarea>

      <div style="display:flex;gap:10px;flex-wrap:wrap">
        <div style="flex:1 1 180px">
          <label>Priority</label>
          <select id="priority">
            <option value="Low">Low</option>
            <option value="Medium">Medium</option>
            <option value="High">High</option>
            <option value="Urgent">Urgent</option>
          </select>
        </div>
        <div style="flex:1 1 180px">
          <label>Status</label>
          <select id="status">
            <option value="To Do">To Do</option>
            <option value="In Progress">In Progress</option>
            <option value="Completed">Completed</option>
            <option value="Blocked">Blocked</option>
          </select>
        </div>
        <div style="flex:1 1 180px">
          <label>Due Date</label>
          <input id="due_date" type="datetime-local"/>
        </div>
      </div>

      <div style="border:1px solid #ddd;padding:12px;margin:12px 0;border-radius:6px;background:#f9f9f9">
        <label style="display:flex;align-items:center;gap:8px;cursor:pointer">
          <input type="checkbox" id="is_recurring" style="width:auto;margin:0" />
          <strong>Make this a recurring task</strong>
        </label>
        <div id="recurring_options" style="display:none;margin-top:10px">
          <label>Recurrence Interval (days)</label>
          <input type="number" id="recurrence_interval_days" min="1" placeholder="e.g., 1 for daily, 7 for weekly" />
          <p style="margin:6px 0;color:#666;font-size:0.9em">
            The task will automatically recur after completion. The next occurrence will be created with a due date calculated from the original due date + interval.
          </p>
          <div id="recurring_info" style="display:none;margin-top:8px;padding:8px;background:#e3f2fd;border-radius:4px;color:#1976d2;font-size:0.9em">
            <span id="recurring_info_text"></span>
          </div>
        </div>
      </div>
      
      <div id="formLoading" style="display:none;padding:10px;text-align:center;color:#666;">
        Updating task...
      </div>
      
      <div style="display:flex;gap:10px;margin-top:16px;">
        <button type="submit" id="updateBtn">Update Task</button>
        <button type="button" onclick="goToDashboard()" style="background:#6c757d">Cancel</button>
        <button type="button" onclick="confirmDelete()" id="deleteBtn" style="background:#dc3545">Archive Task</button>
      </div>
    </form>
    
    <div style="margin-top:16px;padding-top:16px;border-top:1px solid #ddd;">
      <a href="dashboard.html">‚Üê Back to Dashboard</a>
      <span style="margin:0 8px;color:#ccc">|</span>
      <a href="create_task.html">Create New Task</a>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="deleteModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000">
    <div style="background:white; max-width:400px; margin:100px auto; padding:20px; border-radius:8px; box-shadow:0 4px 6px rgba(0,0,0,0.1)">
      <h3 style="margin-top:0">Archive Task</h3>
      <p id="deleteMessage">Are you sure you want to archive this task?</p>
      <div style="display:flex;gap:10px;margin-top:20px;">
        <button onclick="closeDeleteModal()" style="background:#6c757d;color:white;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;">Cancel</button>
        <button onclick="executeDelete()" id="confirmDeleteBtn" style="background:#dc3545;color:white;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;">Archive Task</button>
      </div>
    </div>
  </div>

  <script src="scripts/common.js"></script>
  <script src="scripts/utils.js"></script>  <script src="scripts/edit_task.js"></script>
</body>
</html>