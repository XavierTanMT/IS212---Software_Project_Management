<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="css/common.css">

    <meta charset="UTF-8">
    <title>Admin Dashboard - TaskMgr</title>  <link rel="stylesheet" href="css/admin_dashboard.css">
</head>
<body>
    <div class="container">
    
    <div style="margin: 2rem 0;">
        <h1 style="color: #333; margin-bottom: 0.5rem;">ğŸ‘‘ Admin Dashboard</h1>
        <p style="color: #666;">System-wide administration and user management</p>
    </div>
    
    <div class="stats-grid" id="statsGrid">
        <!-- Stats will be loaded here -->
    </div>
    
    <!-- Tabs -->
    <div class="tabs">
        <button class="tab active" id="tab-overview">ğŸ“Š Overview</button>
        <button class="tab" id="tab-users">ğŸ‘¥ User Management</button>
        <button class="tab" id="tab-projects">ğŸ“ Projects</button>
        <button class="tab" id="tab-reports">ğŸ“ˆ Reports & Export</button>
    </div>
    
    <!-- Tab Content: Overview -->
    <div id="overview-tab" class="tab-content active">
        <div class="section">
            <h2>ğŸ“Š System Overview</h2>
            <div id="systemOverview">
                <p>Loading system statistics...</p>
            </div>
        </div>
    </div>
    
    <!-- Tab Content: User Management -->
    <div id="users-tab" class="tab-content">
        <div class="section">
            <h2>ğŸ‘¥ User Management</h2>
            <div style="margin-bottom: 15px; display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
                <button class="btn btn-success" id="createUserBtn">â• Create New User</button>
                <select id="roleFilter">
                    <option value="">All Roles</option>
                    <option value="staff">Staff</option>
                    <option value="manager">Manager</option>
                    <option value="director">Director</option>
                    <option value="hr">HR</option>
                    <option value="admin">Admin</option>
                </select>
                <select id="statusFilter">
                    <option value="">All Status</option>
                    <option value="active">Active</option>
                    <option value="inactive">Inactive</option>
                </select>
            </div>
            <table class="user-table" id="usersTable">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>User ID</th>
                        <th>Department</th>
                        <th>Role</th>
                        <th>Status</th>
                        <th>Created</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="usersTableBody">
                    <tr><td colspan="8">Loading users...</td></tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Tab Content: Projects -->
    <div id="projects-tab" class="tab-content">
        <div class="section">
            <h2>ğŸ“ All Projects</h2>
            <div id="projectsList">Loading projects...</div>
        </div>
    </div>
    
    <!-- Tab Content: Reports & Export -->
    <div id="reports-tab" class="tab-content">
        <div class="section">
            <h2>ğŸ“ˆ Reports & Export</h2>
            <p>Generate on-demand reports in PDF, CSV, or Excel format. Available to HR/Admin only.</p>
            
            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                <h3>ğŸ“‹ Task Completion Report</h3>
                <p>Generate comprehensive task completion reports with filters</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0;">
                    <!-- Report Type -->
                    <div class="form-group">
                        <label for="reportType">Report Type:</label>
                        <select id="reportType" class="form-control">
                            <option value="summary">Summary Report</option>
                            <option value="user">By User</option>
                            <option value="project">By Project</option>
                        </select>
                    </div>
                    
                    <!-- Format -->
                    <div class="form-group">
                        <label for="reportFormat">Export Format:</label>
                        <select id="reportFormat" class="form-control">
                            <option value="pdf">ğŸ“„ PDF</option>
                            <option value="csv">ğŸ“Š CSV</option>
                            <option value="xlsx">ğŸ“— Excel (XLSX)</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0;">
                    <!-- User Filter -->
                    <div class="form-group">
                        <label for="filterUserId">Filter by User (optional):</label>
                        <input type="text" id="filterUserId" placeholder="user_id" class="form-control">
                        <small>Leave blank for all users</small>
                    </div>
                    
                    <!-- Project Filter -->
                    <div class="form-group">
                        <label for="filterProjectId">Filter by Project (optional):</label>
                        <input type="text" id="filterProjectId" placeholder="project_id" class="form-control">
                        <small>Leave blank for all projects</small>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0;">
                    <!-- Date Range -->
                    <div class="form-group">
                        <label for="startDate">Start Date (Due Date):</label>
                        <input type="date" id="startDate" class="form-control">
                        <small>Filter tasks due on or after this date</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="endDate">End Date (Due Date):</label>
                        <input type="date" id="endDate" class="form-control">
                        <small>Filter tasks due on or before this date</small>
                    </div>
                </div>
                
                <button class="btn btn-primary" id="generateReportBtn" style="width: 100%; padding: 15px; font-size: 16px; margin-top: 10px;">
                    ğŸ“¥ Generate & Download Report
                </button>
                
                <div id="reportMessage" style="margin-top: 15px;"></div>
            </div>
            
            <!-- Quick Report Options -->
            <div style="margin-top: 30px;">
                <h3>âš¡ Quick Reports</h3>
                <p>Generate common reports with one click</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                    <button class="btn btn-success" onclick="quickReport('this_week')">
                        ğŸ“… This Week's Tasks
                    </button>
                    <button class="btn btn-success" onclick="quickReport('this_month')">
                        ğŸ“† This Month's Tasks
                    </button>
                    <button class="btn btn-success" onclick="quickReport('completed')">
                        âœ… All Completed Tasks
                    </button>
                    <button class="btn btn-success" onclick="quickReport('overdue')">
                        âš ï¸ Overdue Tasks
                    </button>
                </div>
            </div>
            
            <!-- Report Stats Preview -->
            <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 8px;">
                <h4>ğŸ’¡ Report Tips</h4>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li><strong>PDF:</strong> Best for presentations and formal reports (limited to 50 tasks)</li>
                    <li><strong>CSV:</strong> Best for quick data analysis and spreadsheet import</li>
                    <li><strong>Excel (XLSX):</strong> Best for detailed analysis with formatted tables</li>
                    <li><strong>Date filters:</strong> Use due date range to focus on specific periods</li>
                    <li><strong>Filters:</strong> Combine user and project filters for targeted reports</li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- Create User Modal -->
    <div id="createUserModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeModalBtn">&times;</span>
            <h2>â• Create New User</h2>
            
            <form id="createUserForm">
                <div class="form-group">
                    <label for="user_id">User ID:</label>
                    <input type="text" id="user_id" required placeholder="unique-user-id">
                    <small>Unique identifier (e.g., emp001, john_doe)</small>
                </div>
                
                <div class="form-group">
                    <label for="name">Full Name:</label>
                    <input type="text" id="name" required placeholder="John Doe">
                </div>
                
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" required placeholder="user@example.com">
                    <small>User will use this email to log in</small>
                </div>
                
                <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" required placeholder="At least 6 characters" minlength="6">
                    <small>Minimum 6 characters - share this with the user securely</small>
                </div>
                
                <div class="form-group">
                    <label for="role">Role:</label>
                    <select id="role" required>
                        <option value="staff">Staff</option>
                        <option value="manager">Manager</option>
                        <option value="director">Director</option>
                        <option value="hr">HR</option>
                        <option value="admin">Admin</option>
                    </select>
                    <small>Determines user permissions and dashboard access</small>
                </div>

                <div class="form-group">
                    <label for="department">Department:</label>
                    <select id="department">
                        <option value="">-- Select Department --</option>
                        <option value="Finance &amp; Accounting">Finance &amp; Accounting</option>
                        <option value="Operations">Operations</option>
                        <option value="Customer Service (Support)">Customer Service (Support)</option>
                        <option value="Sales &amp; Marketing">Sales &amp; Marketing</option>
                        <option value="Product Management">Product Management</option>
                        <option value="Quality Assurance (QA)">Quality Assurance (QA)</option>
                        <option value="IT / Data / Infrastructure">IT / Data / Infrastructure</option>
                        <option value="Legal &amp; Compliance">Legal &amp; Compliance</option>
                    </select>
                    <small>Optional: assign a department to the user</small>
                </div>
                
                <button type="submit" class="btn btn-success" style="width: 100%; margin-top: 10px;">
                    Create User
                </button>
                
                <div id="createUserMessage"></div>
            </form>
        </div>
    </div>
    
    <!-- âœ… Load firebase-auth.js FIRST (it defines API_BASE) -->
    <script src="scripts/common.js"></script>
  <script src="scripts/utils.js"></script>
    <script src="scripts/firebase-auth.js"></script></div> <!-- Close container -->  <script src="scripts/admin_dashboard.js"></script>

</body>
</html>